using Microsoft.VisualStudio.TestTools.UnitTesting;
using MTNBaseClasses.BaseClasses.MasterTerminal;
using MTNForms.Controls;
using MTNForms.FormObjects.EDI_Functions;
using MTNForms.FormObjects.Misc;
using MTNForms.FormObjects.Terminal_Functions;
using MTNUtilityClasses.Classes;
using System;
using MTNForms.FormObjects;

namespace MTNAutomationTests.TestCases.Master_Terminal.EDI_Functions
{
    [TestClass, TestCategory(TestCategories.MTN)]
    public class TestCase41895 : MTNBase
    {

        EDIOperationsForm ediOperationsForm;

        protected static string ediFile1 = "M_41895_ShipManifest.xml";


        [ClassInitialize]
        public static void ClassInitialize(TestContext testContext)
        {
            searchFor = @"M_41895_";
        }


        [TestCleanup]
        public new void TestCleanup()
        {
            base.TestCleanup();
        }

        void MTNInitialize()
        {
            //create Booking file
            CreateDataFile(ediFile1,
              "ignore first line\nCARGO,M,80930100,MSCK000002,ICL,GBLIV,NZLYT,,CONT,,,CAIU8283608,,,,,,,,,,,,,,,\nCARGO,A ,80930100,MSCK000002,ICL,GBLIV,NZLYT,CAIU8283608,GENERAL CARGO,,17604,CAIU8283608-646,'1 PALLET OF PYROMET 901 SOLIDS @ 1366KGS, 19 PALLETS OF ARC 718 @ 16238',CAR51,CAR51,,,,,,,,,,R,,\nCARGO,M,80138800,MSCK000002,ICL,BEANR,NZLYT,,CONT,,,ICUU2150838,,,,,,,,,,,,,,,\nCARGO,A ,80138800,MSCK000002,ICL,BEANR,NZLYT,ICUU2150838,GENERAL CARGO,,15210,ICUU2150838-646,(3 PACKAGES) ALUMINUM BRAZING COILS ,MU1,MU1,,,,,,,,,,R,,\nCARGO,M,80250700,MSCK000002,ICL,GBLIV,NZLYT,,CONT,,,ICUU9152874,,,,,,,,,,,,,,,\nCARGO,A ,80250700,MSCK000002,ICL,GBLIV,NZLYT,ICUU9152874,GENERAL CARGO,,10162,ICUU9152874-646,'(2 PACKAGES) 1 SKIDS INTERNAL COMBUSTION ENGINE PARTS, CASTINGS, FORGINGS AND FILTERS SC573 PLUS 1 LARGE KITS',CUMM,CUMM,,,,,,,,,,R,,\nCARGO,M,80250800,MSCK000002,ICL,GBLIV,NZLYT,,CONT,,,ICUU9160740,,,,,,,,,,,,,,,\nCARGO,A ,80250800,MSCK000002,ICL,GBLIV,NZLYT,ICUU9160740,GENERAL CARGO,,10164,ICUU9160740-646,'(2 PACKAGES) 1 SKIDS INTERNAL COMBUSTION ENGINE PARTS, CASTINGS, FORGINGS AND FILTERS SC573 PLUS 1 LARGE KITS',CUMM,CUMM,,,,,,,,,,R,,\nCARGO,M,80251200,MSCK000002,ICL,GBLIV,NZLYT,,CONT,,,ICUU9637875,,,,,,,,,,,,,,,\nCARGO,A ,80251200,MSCK000002,ICL,GBLIV,NZLYT,ICUU9637875,GENERAL CARGO,,10164,ICUU9637875-646,'(2 PACKAGES) 1 SKIDS INTERNAL COMBUSTION ENGINE PARTS, CASTINGS, FORGINGS AND FILTERS SC573 PLUS 1 LARGE KITS',CUMM,CUMM,,,,,,,,,,R,,\nCARGO,M,80282600,MSCK000002,ICL,GBLIV,NZLYT,,CONT,,,ICUU9638763,,,,,,,,,,,,,,,\nCARGO,A ,80282600,MSCK000002,ICL,GBLIV,NZLYT,ICUU9638763,GENERAL CARGO,,10162,ICUU9638763-646,'(2 PACKAGES) 1 SKIDS INTERNAL COMBUSTION ENGINE PARTS, CASTINGS, FORGINGS AND FILTERS SC573 PLUS 1 LARGE KITS',CUMM,CUMM,,,,,,,,,,R,,\nCARGO,M,80935400,MSCK000002,ICL,GBLIV,NZLYT,,CONT,,,TCNU3430485,,,,,,,,,,,,,,,\nCARGO,A ,80935400,MSCK000002,ICL,GBLIV,NZLYT,TCNU3430485,GENERAL CARGO,,10162,TCNU3430485-646,'(2 PC)1 SKIDS INTERNAL COMBUSTION ENGINE PARTS, CASTINGS, FORGINGS AND FILTERS SC573 PLUS 1 LARGE KITS',CUMM,CUMM,,,,,,,,,,R,,\nCARGO,M,80946000,MSCK000002,ICL,GBLIV,NZLYT,,CONT,,,ICUU9606998,,,,,,,,,,,,,,,\nCARGO,A ,80946000,MSCK000002,ICL,GBLIV,NZLYT,ICUU9606998,GENERAL CARGO,,16185,ICUU9606998-646,'(4 PC)2 SKIDS INTERNAL COMBUSTION ENGINE PARTS, CASTINGS, FORGINGS AND FILTERS SC573 PLUS 2 LARGE KITS',CUMM,CUMM,,,,,,,,,,R,,\nCARGO,M,80932300,MSCK000002,ICL,GBLIV,NZLYT,,CONT,,,CAIU4207132,,,,,,,,,,,,,,,\nCARGO,A ,80932300,MSCK000002,ICL,GBLIV,NZLYT,CAIU4207132,GENERAL CARGO,,2907,CAIU4207132-646,'(9 CS)S2-SE-02 ASSY,SAMPLESTORE SE, 12 COLUMN, 02 SO#1192477',GLAXO,GLAXO,,,,,,,,,,R,,\nCARGO,M,80914000,MSCK000002,ICL,GBLIV,NZLYT,,CONT,,,ICUU2150231,,,,,,,,,,,,,,,\nCARGO,A ,80914000,MSCK000002,ICL,GBLIV,NZLYT,ICUU2150231,GENERAL CARGO,,1245,ICUU2150231-646,1 X JAGUAR E-TYPE CAR,JAGLR,JAGLR,,,,,,,,,,R,,\nCARGO,M,80284400,MSCK000002,ICL,GBLIV,NZLYT,,CONT,,,CAIU8662725,,,,,,,,,,,,,,,\nCARGO,A ,80284400,MSCK000002,ICL,GBLIV,NZLYT,CAIU8662725,GENERAL CARGO,,11754,CAIU8662725-646,(13 PALLETS)PYROMET 718 VQ TURNINGS,LATSS,LATSS,,,,,,,,,,R,,\nCARGO,M,80284400,MSCK000002,ICL,GBLIV,NZLYT,,CONT,,,CAIU8844674,,,,,,,,,,,,,,,\nCARGO,A ,80284400,MSCK000002,ICL,GBLIV,NZLYT,CAIU8844674,GENERAL CARGO,,13830,CAIU8844674-646,(13 PALLETS)PYROMET 718 TUNRINGS,LATSS,LATSS,,,,,,,,,,R,,\nCARGO,M,80286400,MSCK000002,ICL,GBLIV,NZLYT,,CONT,,,ICUU9602349,,,,,,,,,,,,,,,\nCARGO,A ,80286400,MSCK000002,ICL,GBLIV,NZLYT,ICUU9602349,GENERAL CARGO,,23120,ICUU9602349-646,(16 PALLETS)PYROMET 718 SOLIDS,LATSS,LATSS,,,,,,,,,,R,,\nCARGO,M,80094400,MSCK000002,ICL,BEANR,NZLYT,,CONT,,,ICUU8370280,,,,,,,,,,,,,,,\nCARGO,A ,80094400,MSCK000002,ICL,BEANR,NZLYT,ICUU8370280,GENERAL CARGO,,20040,ICUU8370280-646,(12 PACKAGES)ALUMINIUM PRODUCTS,OT1,OT1,,,,,,,,,,R,,\nCARGO,M,80945400,MSCK000002,ICL,GBLIV,NZLYT,,CONT,,,ICUU2141610,,,,,,,,,,,,,,,\nCARGO,A ,80945400,MSCK000002,ICL,GBLIV,NZLYT,ICUU2141610,GENERAL CARGO,,10590,ICUU2141610-646,10 X SKID & VCI PACKED ALTERNATORS,ONANC,ONANC,,,,,,,,,,R,,\nCARGO,M,80252100,MSCK000002,ICL,GBLIV,NZLYT,,CONT,,,BSIU2981309,,,,,,,,,,,,,,,\nCARGO,A ,80252100,MSCK000002,ICL,GBLIV,NZLYT,BSIU2981309,GENERAL CARGO,,21250,BSIU2981309-646,(21 BUNDLES) STEEL BARS,PS1,PS1,,,,,,,,,,R,,\nCARGO,M,80117100,MSCK000002,ICL,BEANR,NZLYT,,CONT,,,BSIU9746960,,,,,,,,,,,,,,,\nCARGO,A ,80117100,MSCK000002,ICL,BEANR,NZLYT,BSIU9746960,GENERAL CARGO,,16663,BSIU9746960-646,'(11 TUBES)Precision Steel Tubes, Seamless, Cold Drawn',16777,16777,,,,,,,,,,R,,\nCARGO,M,80197700,MSCK000002,ICL,GBLIV,NZLYT,,CONT,,,ICUU2370616,,,,,,,,,,,,,,,\nCARGO,A ,80197700,MSCK000002,ICL,GBLIV,NZLYT,ICUU2370616,GENERAL CARGO,,15957,ICUU2370616-646,(2 PC)TITANIUM INGOTS,1065L,1065L,,,,,,,,,,R,,\nCARGO,M,80197700,MSCK000002,ICL,GBLIV,NZLYT,,CONT,,,ICUU2371145,,,,,,,,,,,,,,,\nCARGO,A ,80197700,MSCK000002,ICL,GBLIV,NZLYT,ICUU2371145,GENERAL CARGO,,15939,ICUU2371145-646,(2 PC)TITANIUM INGOTS,1065L,1065L,,,,,,,,,,R,,\nCARGO,M,80197700,MSCK000002,ICL,GBLIV,NZLYT,,CONT,,,ICUU2371510,,,,,,,,,,,,,,,\nCARGO,A ,80197700,MSCK000002,ICL,GBLIV,NZLYT,ICUU2371510,GENERAL CARGO,,15926,ICUU2371510-646,(2 PC)TITANIUM INGOTS,1065L,1065L,,,,,,,,,,R,,\nCARGO,M,80197700,MSCK000002,ICL,GBLIV,NZLYT,,CONT,,,ICUU2372476,,,,,,,,,,,,,,,\nCARGO,A ,80197700,MSCK000002,ICL,GBLIV,NZLYT,ICUU2372476,GENERAL CARGO,,15931,ICUU2372476-646,(2 PC)TITANIUM INGOTS,1065L,1065L,,,,,,,,,,R,,\nCARGO,M,80197700,MSCK000002,ICL,GBLIV,NZLYT,,CONT,,,ICUU2372990,,,,,,,,,,,,,,,\nCARGO,A ,80197700,MSCK000002,ICL,GBLIV,NZLYT,ICUU2372990,GENERAL CARGO,,15917,ICUU2372990-646,(2 PC)TITANIUM INGOTS,1065L,1065L,,,,,,,,,,R,,\nCARGO,M,80197700,MSCK000002,ICL,GBLIV,NZLYT,,CONT,,,ICUU2373071,,,,,,,,,,,,,,,\nCARGO,A ,80197700,MSCK000002,ICL,GBLIV,NZLYT,ICUU2373071,GENERAL CARGO,,15940,ICUU2373071-646,(2 PC)TITANIUM INGOTS,1065L,1065L,,,,,,,,,,R,,\nCARGO,M,80197700,MSCK000002,ICL,GBLIV,NZLYT,,CONT,,,ICUU2373317,,,,,,,,,,,,,,,\nCARGO,A ,80197700,MSCK000002,ICL,GBLIV,NZLYT,ICUU2373317,GENERAL CARGO,,15933,ICUU2373317-646,(2 PC)TITANIUM INGOTS,1065L,1065L,,,,,,,,,,R,,\nCARGO,M,80197700,MSCK000002,ICL,GBLIV,NZLYT,,CONT,,,ICUU2373488,,,,,,,,,,,,,,,\nCARGO,A ,80197700,MSCK000002,ICL,GBLIV,NZLYT,ICUU2373488,GENERAL CARGO,,15922,ICUU2373488-646,(2 PC)TITANIUM INGOTS,1065L,1065L,,,,,,,,,,R,,\nCARGO,M,80197700,MSCK000002,ICL,GBLIV,NZLYT,,CONT,,,ICUU3752906,,,,,,,,,,,,,,,\nCARGO,A ,80197700,MSCK000002,ICL,GBLIV,NZLYT,ICUU3752906,GENERAL CARGO,,15936,ICUU3752906-646,(2 PC)TITANIUM INGOTS,1065L,1065L,,,,,,,,,,R,,");

            MTNSignon(TestContext);

            // set configuration as required by test
            FormObjectBase.NavigationMenuSelection(@"Terminal Ops|Terminal Config");
            TerminalConfigForm terminalConfigForm = new TerminalConfigForm();
            terminalConfigForm.SetTerminalConfiguration(@"EDI", @"EDI Allow Partial Loading of Ship Manifest", @"1", rowDataType: EditRowDataType.CheckBox);
            terminalConfigForm.CloseForm();
        }


        [TestMethod]
        public void EDIFileLoadwithGCIDs()
        {
            
            MTNInitialize();

            // 1. Open EDI Operations and load the ship manifest
            FormObjectBase.NavigationMenuSelection(@"EDI Functions|EDI Operations", forceReset: true);
            ediOperationsForm = new EDIOperationsForm(@"EDI Operations TT1");
            ediOperationsForm.DeleteEDIMessages(@"Ship Manifest", @"41895", ediStatus: @"Loaded");
            ediOperationsForm.LoadEDIMessageFromFile(ediFile1,specifyType: true, fileType: @"User Defined Ship Manifest - 41591");
            ediOperationsForm.ChangeEDIStatus(ediFile1, @"Loaded", @"Verify");

            /*MTNControlBase.FindTabOnForm(ediOperationsForm.tabEDIDetails, @"Cargo On Ship");
            ediOperationsForm.ShowEDIDataTable(@"6166");*/
            //ediOperationsForm.GetTabTableGeneric(@"Cargo On Ship", @"6188");
            ediOperationsForm.GetTabTableGeneric(@"Cargo On Ship");

            //Check that the EDI data table has not changed the General Cargo IDs
            MTNControlBase.FindClickRowInTable(ediOperationsForm.tblEDIDetails, @"ID^ICUU2370616-646", ClickType.None,searchType: SearchType.Exact,rowHeight: 16);
            MTNControlBase.FindClickRowInTable(ediOperationsForm.tblEDIDetails, @"ID^ICUU3752906-646", ClickType.None, searchType: SearchType.Exact, rowHeight: 16);
            MTNControlBase.FindClickRowInTable(ediOperationsForm.tblEDIDetails, @"ID^ICUU8370280-646", ClickType.None, searchType: SearchType.Exact, rowHeight: 16);
            
        }




    }

}
