using Microsoft.VisualStudio.TestTools.UnitTesting;
using MTNBaseClasses.BaseClasses.MasterTerminal;
using MTNForms.FormObjects.EDI_Functions;
using MTNForms.FormObjects.Misc;
using System;
using MTNForms.FormObjects;
using MTNUtilityClasses.Classes;

namespace MTNAutomationTests.TestCases.Master_Terminal.EDI_Functions
{
    [TestClass, TestCategory(TestCategories.MTN)]
    public class TestCase44036 : MTNBase
    {
        EDIOperationsForm ediOperationsForm;

        protected static string ediFile1 = "M_44036_CustomsReleaseMessage.xml";

        [ClassInitialize]
        public static void ClassInitialize(TestContext testContext)
        {
            searchFor = @"M_44036_";
        }


        [TestCleanup]
        public new void TestCleanup()
        {
            base.TestCleanup();
        }

        void MTNInitialize()
        {
             //Create EDI file
            CreateDataFile(ediFile1,
               "<?xml version='1.0' encoding='UTF-8' standalone='yes'?>\n<ReleaseDuesNotification>\n    <NotificationSender>GAC</NotificationSender>\n    <NotificationRef>1h5p4Q-4B6F-0k5P2v-0z0v5W-2o8P</NotificationRef>\n    <NotificationDate>2018-12-12T00:00:00.000+03:00</NotificationDate>\n    <Declaration>\n        <declarationNo>5SI60009822932</declarationNo>\n        <declarationStatus>Released</declarationStatus>\n        <declarationType>IMP</declarationType>\n        <submittedDate>11/12/2018 15:33:14</submittedDate>\n        <clearingAgency>1593</clearingAgency>\n        <clearingAgent>4173</clearingAgent>\n        <billOfLading>BSLKHMD26566</billOfLading>\n        <cargoManifestNo>NSM010979</cargoManifestNo>\n        <hscodeItemDesc>- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials</hscodeItemDesc>\n        <hscode>63062900,63062900,63062900,63062900,63062900,63062900</hscode>\n        <carrierName>BOMAR HERMES</carrierName>\n        <voyageNo>0015/2018</voyageNo>\n        <containerNo>TTNU1388429</containerNo>\n        <isLCL></isLCL>\n        <sealNo>257599</sealNo>\n        <releaseOrderNumber>18121213900433</releaseOrderNumber>\n    </Declaration>\n    <Declaration>\n        <declarationNo>5SI60009812855</declarationNo>\n        <declarationStatus>Released</declarationStatus>\n        <declarationType>IMP</declarationType>\n        <submittedDate>10/12/2018 12:21:04</submittedDate>\n        <clearingAgency>1492</clearingAgency>\n        <clearingAgent>4245</clearingAgent>\n        <billOfLading>HLCUBSC181080180</billOfLading>\n        <cargoManifestNo>555750265</cargoManifestNo>\n        <hscodeItemDesc>- - Other</hscodeItemDesc>\n        <hscode>34021900</hscode>\n        <carrierName>NAGOYA TOWER</carrierName>\n        <voyageNo>807W</voyageNo>\n        <containerNo>BSIU2313188</containerNo>\n        <isLCL>N</isLCL>\n        <sealNo>0026864</sealNo>\n        <releaseOrderNumber>18121213900397</releaseOrderNumber>\n    </Declaration>\n    <Declaration>\n        <declarationNo>5SR60009801432</declarationNo>\n        <declarationStatus>Released</declarationStatus>\n        <declarationType>REE</declarationType>\n        <submittedDate>09/12/2018 00:00:45</submittedDate>\n        <clearingAgency>1593</clearingAgency>\n        <clearingAgent>3926</clearingAgent>\n        <billOfLading>HMD/TUB/18/02803</billOfLading>\n        <cargoManifestNo></cargoManifestNo>\n        <hscodeItemDesc>Copper waste and scrap</hscodeItemDesc>\n        <hscode>74040000</hscode>\n        <carrierName>NORTHERN PRELUDE</carrierName>\n        <voyageNo>806E</voyageNo>\n        <containerNo>SEGU3401665</containerNo>\n        <isLCL></isLCL>\n        <sealNo></sealNo>\n        <releaseOrderNumber>18121213900426</releaseOrderNumber>\n    </Declaration>\n    <Declaration>\n        <declarationNo>5SI60009820538</declarationNo>\n        <declarationStatus>Released</declarationStatus>\n        <declarationType>IMP</declarationType>\n        <submittedDate>11/12/2018 12:45:12</submittedDate>\n        <clearingAgency>1017</clearingAgency>\n        <clearingAgent>1628</clearingAgent>\n        <billOfLading>GACDO01353</billOfLading>\n        <cargoManifestNo>GAC-QADOH5209001386</cargoManifestNo>\n        <hscodeItemDesc>- Registers, account books, Note books, order books, receipt books, Letter pads, memorandum pads, diaries and similar articles,- Registers, account books, Note books, order books, receipt books, Letter pads, memorandum pads, diaries and similar articles,- Registers, account books, Note books, order books, receipt books, Letter pads, memorandum pads, diaries and similar articles</hscodeItemDesc>\n        <hscode>48201000,48201000,48201000</hscode>\n        <carrierName>MAERSK KLAIPEDA</carrierName>\n        <voyageNo>1813</voyageNo>\n        <containerNo>MSKU1925952</containerNo>\n        <isLCL>Y</isLCL>\n        <sealNo>1350298</sealNo>\n        <releaseOrderNumber>18121213900429</releaseOrderNumber>\n    </Declaration>\n    <Declaration>\n        <declarationNo>5SI60009820687</declarationNo>\n        <declarationStatus>Released</declarationStatus>\n        <declarationType>IMP</declarationType>\n        <submittedDate>11/12/2018 13:35:33</submittedDate>\n        <clearingAgency>1455</clearingAgency>\n        <clearingAgent>1536</clearingAgent>\n        <billOfLading>QNLMUNHMD1819067</billOfLading>\n        <cargoManifestNo>QTC303537</cargoManifestNo>\n        <hscodeItemDesc>- - - Confectionery wrappers, fruit wrappers and other wrappings cut to size</hscodeItemDesc>\n        <hscode>48239010</hscode>\n        <carrierName>NAGOYA TOWER</carrierName>\n        <voyageNo>806-W</voyageNo>\n        <containerNo>CAIU2220198</containerNo>\n        <isLCL></isLCL>\n        <sealNo>014217</sealNo>\n        <releaseOrderNumber>18121213900434</releaseOrderNumber>\n    </Declaration>\n    <Declaration>\n        <declarationNo>5SI60009834375</declarationNo>\n        <declarationStatus>Released</declarationStatus>\n        <declarationType>IMP</declarationType>\n        <submittedDate>12/12/2018 00:03:08</submittedDate>\n        <clearingAgency>1593</clearingAgency>\n        <clearingAgent>3926</clearingAgent>\n        <billOfLading>967032804</billOfLading>\n        <cargoManifestNo>MSK00000000040996</cargoManifestNo>\n        <hscodeItemDesc>- - - Other,- - - Other,- - - Other,- - - Other,- - - Other</hscodeItemDesc>\n        <hscode>94034090,94034090,94034090,94034090,94034090</hscode>\n        <carrierName>MAERSK KLAIPEDA</carrierName>\n        <voyageNo>1813</voyageNo>\n        <containerNo>HASU4915440</containerNo>\n        <isLCL>N</isLCL>\n        <sealNo>OM2096067</sealNo>\n        <releaseOrderNumber>18121213900427</releaseOrderNumber>\n    </Declaration>\n    <Declaration>\n        <declarationNo>5SI60009832671</declarationNo>\n        <declarationStatus>Released</declarationStatus>\n        <declarationType>IMP</declarationType>\n        <submittedDate>11/12/2018 22:35:17</submittedDate>\n        <clearingAgency>1455</clearingAgency>\n        <clearingAgent>1536</clearingAgent>\n        <billOfLading>MEDUIZ304318</billOfLading>\n        <cargoManifestNo>1202180798</cargoManifestNo>\n        <hscodeItemDesc>- - Marble, travertine and alabaster,- - Marble, travertine and alabaster,- - Marble, travertine and alabaster,- - Marble, travertine and alabaster,- - Marble, travertine and alabaster,- - Marble, travertine and alabaster,- - Marble, travertine and alabaster,- - Marble, travertine and alabaster,- - Marble, travertine and alabaster,- - Marble, travertine and alabaster,- - Marble, travertine and alabaster</hscodeItemDesc>\n        <hscode>68022100,68022100,68022100,68022100,68022100,68022100,68022100,68022100,68022100,68022100,68022100</hscode>\n        <carrierName>MSC ABIDJAN</carrierName>\n        <voyageNo>IT849R</voyageNo>\n        <containerNo>CLHU2790837,GLDU2946512,IPXU3870909,MEDU2695933,MEDU3613734,TEMU4342650,TRHU1731210</containerNo>\n        <isLCL>N,N,N,N,N,N,N</isLCL>\n        <sealNo>EU15103637,EU15103636,EU15103638,EU15103634,EU15103635,EU15103633,EU15103632</sealNo>\n        <releaseOrderNumber>18121213900436</releaseOrderNumber>\n    </Declaration>\n    <Declaration>\n        <declarationNo>5SR60009834690</declarationNo>\n        <declarationStatus>Released</declarationStatus>\n        <declarationType>REE</declarationType>\n        <submittedDate>12/12/2018 00:11:30</submittedDate>\n        <clearingAgency>1593</clearingAgency>\n        <clearingAgent>3926</clearingAgent>\n        <billOfLading>QAMU1800573</billOfLading>\n        <cargoManifestNo></cargoManifestNo>\n        <hscodeItemDesc>Copper waste and scrap</hscodeItemDesc>\n        <hscode>74040000</hscode>\n        <carrierName>HYUNDAI VICTORY</carrierName>\n        <voyageNo>027E</voyageNo>\n        <containerNo>DFSU2785895</containerNo>\n        <isLCL></isLCL>\n        <sealNo></sealNo>\n        <releaseOrderNumber>18121213900395</releaseOrderNumber>\n    </Declaration>\n    <Declaration>\n        <declarationNo>5SI60009820606</declarationNo>\n        <declarationStatus>Released</declarationStatus>\n        <declarationType>IMP</declarationType>\n        <submittedDate>11/12/2018 13:04:57</submittedDate>\n        <clearingAgency>1593</clearingAgency>\n        <clearingAgent>4173</clearingAgent>\n        <billOfLading>OVG/KHI/HMD-10519/18</billOfLading>\n        <cargoManifestNo>EVR-EBSL006083</cargoManifestNo>\n        <hscodeItemDesc>- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials,- - Of other textile materials</hscodeItemDesc>\n        <hscode>63062900,63062900,63062900,63062900,63062900,63062900,63062900,63062900,63062900,63062900,63062900,63062900,63062900,63062900,63062900,63062900,63062900,63062900,63062900,63062900,63062900,63062900,63062900,63062900,63062900,63062900,63062900,63062900</hscode>\n        <carrierName>BOMER HERMES</carrierName>\n        <voyageNo>0015</voyageNo>\n        <containerNo>ECMU9075775</containerNo>\n        <isLCL>N</isLCL>\n        <sealNo>017735</sealNo>\n        <releaseOrderNumber>18121213900431</releaseOrderNumber>\n    </Declaration>\n    <Declaration>\n        <declarationNo>5SI60009820638</declarationNo>\n        <declarationStatus>Released</declarationStatus>\n        <declarationType>IMP</declarationType>\n        <submittedDate>11/12/2018 13:16:27</submittedDate>\n        <clearingAgency>1414</clearingAgency>\n        <clearingAgent>2494</clearingAgent>\n        <billOfLading>SOHHMD000344</billOfLading>\n        <cargoManifestNo>QTC008740</cargoManifestNo>\n        <hscodeItemDesc>- - - Central air conditioning machines,- - - Central air conditioning machines,- - - Central air conditioning machines,- - - Other,- Parts,- Parts,- Parts,- Parts,- - - Other,- - - Other</hscodeItemDesc>\n        <hscode>84158120,84158120,84158120,84158390,84159000,84159000,84159000,84159000,85044090,85044090</hscode>\n        <carrierName>AL BIDDA</carrierName>\n        <voyageNo>852W</voyageNo>\n        <containerNo>TCKU9567531</containerNo>\n        <isLCL>N</isLCL>\n        <sealNo>.</sealNo>\n        <releaseOrderNumber>18121213900435</releaseOrderNumber>\n    </Declaration>\n    <Declaration>\n        <declarationNo>5SI60009824099</declarationNo>\n        <declarationStatus>Released</declarationStatus>\n        <declarationType>IMP</declarationType>\n        <submittedDate>11/12/2018 16:37:34</submittedDate>\n        <clearingAgency>1017</clearingAgency>\n        <clearingAgent>697</clearingAgent>\n        <billOfLading>HMD202388</billOfLading>\n        <cargoManifestNo>TFS-01AR853</cargoManifestNo>\n        <hscodeItemDesc>- - - Glass and mirror polishes,- Chandeliers and other electric ceiling or wall lighting fittings, excluding those of a kind used for lighting public open spaces or thoroughfares,- Chandeliers and other electric ceiling or wall lighting fittings, excluding those of a kind used for lighting public open spaces or thoroughfares,- Chandeliers and other electric ceiling or wall lighting fittings, excluding those of a kind used for lighting public open spaces or thoroughfares,- Chandeliers and other electric ceiling or wall lighting fittings, excluding those of a kind used for lighting public open spaces or thoroughfares</hscodeItemDesc>\n        <hscode>34059010,94051000,94051000,94051000,94051000</hscode>\n        <carrierName>AL RUMEILA</carrierName>\n        <voyageNo>853W</voyageNo>\n        <containerNo>TGHU8904779</containerNo>\n        <isLCL>Y</isLCL>\n        <sealNo>010889297</sealNo>\n        <releaseOrderNumber>18121213900399</releaseOrderNumber>\n    </Declaration>\n</ReleaseDuesNotification>\n");

            MTNSignon(TestContext);
        }


        [TestMethod]
        public void CustomsReleaseMessageWithUNH()
        {

            MTNInitialize();
            
            // 1. Open EDI Operations
            FormObjectBase.NavigationMenuSelection(@"EDI Functions|EDI Operations");
            ediOperationsForm = new EDIOperationsForm(@"EDI Operations TT1");

            // 1b. Delete Existing EDI messages relating to this test.
            ediOperationsForm.DeleteEDIMessages(@"Custom Stops", @"43944");

            // 2. Load CUSCAR file
            ediOperationsForm.LoadEDIMessageFromFile(ediFile1);

   
        }


    }

}
