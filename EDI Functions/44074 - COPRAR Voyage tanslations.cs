using Microsoft.VisualStudio.TestTools.UnitTesting;
using MTNBaseClasses.BaseClasses.MasterTerminal;
using MTNForms.Controls;
using MTNForms.FormObjects.EDI_Functions;
using MTNForms.FormObjects.Misc;
using System;
using MTNForms.FormObjects;
using MTNUtilityClasses.Classes;

namespace MTNAutomationTests.TestCases.Master_Terminal.EDI_Functions
{
    [TestClass, TestCategory(TestCategories.MTN)]
    public class TestCase44074 : MTNBase
    {
        EDIOperationsForm ediOperationsForm;

        protected static string ediFile1 = "M_44074_COPRARA.edi";
        protected static string ediFile2 = "M_44074_COPRARB.edi";

        [ClassInitialize]
        public static void ClassInitialize(TestContext testContext)
        {
            searchFor = @"M_44074_";
        }


        [TestCleanup]
        public new void TestCleanup()
        {
            base.TestCleanup();
        }

        void MTNInitialize()
        {
            //Create CUSRES EDI file with VN
            CreateDataFile(ediFile1,
               "UNA:+.'\nUNB+UNOA:2+HAPAG-LLOYD+ITSALSCT+181012:1402+3099'\nUNH+CFEITSAL003454+COPRAR:D:95B:UN:SMDG10'\nBGM+45:::LOADING ORDER+CFEITSAL003454+9'\nRFF+XXX:1'\nTDT+20+44074+1++HLL:172:20+++9V3818:103::MAERSK PATRAS'\nRFF+VON:218905'\nLOC+9+ITSAL:139:6++:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nDTM+133:201810142130:203'\nDTM+132:201810140800:203'\nNAD+CF+HLL:160:166'\nEQD+CN+SEGU2701478+22G1:102:5++2+5'\nRFF+BN:82173607'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+BEANR:139:6'\nLOC+7+NLTLB:139:6'\nMEA+AAE+T+KGM:2180'\nMEA+AAE+G+KGM:25056'\nMEA+AAE+VGM+KGM:27236'\nSEL+HLK0018487+CA'\nSEL+HLK0018487+SH'\nSEL+0018487+CA'\nFTX+AAA+++PASTA'\nTDT+10+188E+1+13+HLL:172:20+++9HA3756:103::MOLIVA:MT'\nRFF+VON:589735'\nLOC+5+ITTPS:139:6'\nDTM+132:201810091142:203'\nNAD+CF+HLL:160:166'\nEQD+CN+HLXU8419680+45G1:102:5++2+5'\nRFF+BN:50067427'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+NOOSL:139:6'\nMEA+AAE+T+KGM:3900'\nMEA+AAE+G+KGM:5831'\nMEA+AAE+VGM+KGM:9731'\nSEL+UASC 82083+AB'\nSEL+Y 6111470+AB'\nSEL+Y 6111469+AB'\nFTX+AAA+++ITALIAN PASTA'\nTDT+10++3+31'\nLOC+5+ITSAL:139:6'\nDTM+132:201810130000:203'\nNAD+CF+HLL:160:166'\nEQD+CN+TEMU6851404+45G1:102:5++2+5'\nRFF+BN:50067427'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+NOOSL:139:6'\nMEA+AAE+T+KGM:3890'\nMEA+AAE+G+KGM:7140'\nMEA+AAE+VGM+KGM:11030'\nSEL+UASC 82083+SH'\nSEL+Y 6111382-+SH'\nFTX+AAA+++ITALIAN PASTA'\nTDT+10++3+31'\nLOC+5+ITSAL:139:6'\nDTM+132:201810130000:203'\nNAD+CF+HLL:160:166'\nEQD+CN+HLXU1227367+22G1:102:5++2+5'\nRFF+BN:51067598'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+NOOSL:139:6'\nMEA+AAE+T+KGM:2350'\nMEA+AAE+G+KGM:21300'\nMEA+AAE+VGM+KGM:23650'\nSEL+8208288+SH'\nSEL+0010746+SH'\nFTX+AAA+++CHOPPED TOMATOES 6X2550G NET OTG'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810080000:203'\nNAD+CF+HLL:160:166'\nEQD+CN+FCIU3072600+22G1:102:5++2+5'\nRFF+BN:51401090'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+NOOSL:139:6'\nMEA+AAE+T+KGM:2220'\nMEA+AAE+G+KGM:10278'\nMEA+AAE+VGM+KGM:12498'\nSEL+1822925+AB'\nFTX+AAA+++TOMATO SAUCE'\nTDT+10++3+31'\nLOC+5+ITSAL:139:6'\nDTM+132:201810130000:203'\nNAD+CF+HLL:160:166'\nEQD+CN+TCLU4150748+42G1:102:5++2+5'\nRFF+BN:52067861'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+RULED:139:6'\nMEA+AAE+T+KGM:3710'\nMEA+AAE+G+KGM:25350'\nMEA+AAE+VGM+KGM:29060'\nSEL+M1464061+SH'\nSEL+M1464061+SH'\nFTX+AAA+++MINERAL WATER'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN+TCNU7787125+45G1:102:5++2+5'\nRFF+BN:54065946'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+NOOSL:139:6'\nMEA+AAE+T+KGM:3900'\nMEA+AAE+G+KGM:17240'\nMEA+AAE+VGM+KGM:21140'\nSEL+609347+AB'\nFTX+AAA+++MISTO DI NOCCIOLE, NOCCIOLE IN GUSC'\nTDT+10++3+31'\nLOC+5+ITSAL:139:6'\nDTM+132:201810130000:203'\nNAD+CF+HLL:160:166'\nEQD+CN+HLXU6526458+45G1:102:5++2+5'\nRFF+BN:54065946'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+NOOSL:139:6'\nMEA+AAE+T+KGM:4080'\nMEA+AAE+G+KGM:25780'\nMEA+AAE+VGM+KGM:29860'\nSEL+1440151+SH'\nFTX+AAA+++MISTO DI NOCCIOLE, NOCCIOLE IN GUSC'\nTDT+10++3+31'\nLOC+5+ITSAL:139:6'\nDTM+132:201810130000:203'\nNAD+CF+HLL:160:166'\nEQD+CN+HLXU1138547+22G1:102:5++2+5'\nRFF+BN:54065946'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+NOOSL:139:6'\nMEA+AAE+T+KGM:2350'\nMEA+AAE+G+KGM:7325'\nMEA+AAE+VGM+KGM:9675'\nSEL+1443026+AB'\nFTX+AAA+++MISTO DI NOCCIOLE, NOCCIOLE IN GUSC'\nTDT+10++3+31'\nLOC+5+ITSAL:139:6'\nDTM+132:201810110000:203'\nNAD+CF+HLL:160:166'\nEQD+CN+UACU4013894+22G1:102:5++2+5'\nRFF+BN:54399671'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+DKCPH:139:6'\nMEA+AAE+T+KGM:2300'\nMEA+AAE+G+KGM:21420'\nMEA+AAE+VGM+KGM:23720'\nSEL+HLA4659484+SH'\nSEL+HLA4659484+SH'\nSEL+4659484+CA'\nFTX+AAA+++ORANGE CONCENTRATE'\nTDT+10+189E+1+13+HLL:172:20+++9HA3756:103::MOLIVA:MT'\nRFF+VON:591050'\nLOC+5+ITCTA:139:6'\nDTM+132:201810091142:203'\nNAD+CF+HLL:160:166'\nEQD+CN+HLXU1195589+22G1:102:5++2+5'\nRFF+BN:54733596'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+DEHAM:139:6'\nMEA+AAE+T+KGM:2350'\nMEA+AAE+G+KGM:21840'\nMEA+AAE+VGM+KGM:24190'\nSEL+8208285+CU'\nFTX+AAA+++BEANS'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN+IPXU3892620+22G1:102:5++2+5'\nRFF+BN:54733596'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+DEHAM:139:6'\nMEA+AAE+T+KGM:2240'\nMEA+AAE+G+KGM:21340'\nMEA+AAE+VGM+KGM:23580'\nSEL+3269319+SH'\nFTX+AAA+++BEANS'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN+TEMU1472558+22G1:102:5++2+5'\nRFF+BN:55067809'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+NOOSL:139:6'\nMEA+AAE+T+KGM:2060'\nMEA+AAE+G+KGM:18708'\nMEA+AAE+VGM+KGM:20768'\nSEL+1441503+SH'\nSEL+048422+SH'\nFTX+AAA+++RED KIDNEY BEANS'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810090000:203'\nNAD+CF+HLL:160:166'\nEQD+CN++22GP:102:5++2+5'\nRFF+BN:55398868'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+RULED:139:6'\nMEA+AAE+T+KGM:2300'\nMEA+AAE+G+KGM:20585'\nFTX+AAA+++CANNED TOMATOES'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN+HLXU1222410+22G1:102:5++2+5'\nRFF+BN:55398868'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+RULED:139:6'\nMEA+AAE+T+KGM:2350'\nMEA+AAE+G+KGM:21600'\nMEA+AAE+VGM+KGM:23950'\nSEL+8209659+CA'\nFTX+AAA+++CANNED TOMATOES'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN++42PC:102:5++2+4'\nRFF+BN:55401201'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+DEHAM:139:6'\nMEA+AAE+T+KGM:5800'\nTDT+10++1+13'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN++42PC:102:5++2+4'\nRFF+BN:55401201'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+DEHAM:139:6'\nMEA+AAE+T+KGM:5800'\nTDT+10++1+13'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN++42PC:102:5++2+4'\nRFF+BN:55401201'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+DEHAM:139:6'\nMEA+AAE+T+KGM:5800'\nTDT+10++1+13'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN++42PC:102:5++2+4'\nRFF+BN:55401201'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+DEHAM:139:6'\nMEA+AAE+T+KGM:5800'\nTDT+10++1+13'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN++42PC:102:5++2+4'\nRFF+BN:55401201'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+DEHAM:139:6'\nMEA+AAE+T+KGM:5800'\nTDT+10++1+13'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN++42PC:102:5++2+4'\nRFF+BN:55401201'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+DEHAM:139:6'\nMEA+AAE+T+KGM:5800'\nTDT+10++1+13'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN+UACU3733436+22G1:102:5++2+5'\nRFF+BN:57066341'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+EEMUG:139:6'\nMEA+AAE+T+KGM:2300'\nMEA+AAE+G+KGM:11500'\nMEA+AAE+VGM+KGM:13800'\nSEL+1213170+CU'\nFTX+AAA+++TOMATOES'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN+HAMU1089390+22G1:102:5++2+5'\nRFF+BN:58399851'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+NOOSL:139:6'\nMEA+AAE+T+KGM:2300'\nMEA+AAE+G+KGM:20760'\nMEA+AAE+VGM+KGM:23060'\nSEL+6838407+SH'\nSEL+0010725+SH'\nSEL+6838407+CU'\nSEL+0010725+CU'\nFTX+AAA+++TOMATOES'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN+UACU3853302+22G1:102:5++2+5'\nRFF+BN:82247849'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+RULED:139:6'\nMEA+AAE+T+KGM:2290'\nMEA+AAE+G+KGM:22160'\nMEA+AAE+VGM+KGM:24450'\nSEL+8208326+SH'\nFTX+AAA+++STEEL WIRE'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN+CAIU2158297+22G1:102:5++2+5'\nRFF+BN:82265575'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+SEHEL:139:6'\nMEA+AAE+T+KGM:2185'\nMEA+AAE+G+KGM:21800'\nMEA+AAE+VGM+KGM:23985'\nSEL+018693+SH'\nSEL+018693+AB'\nFTX+AAA+++CHICK PEAS'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810080000:203'\nNAD+CF+HLL:160:166'\nEQD+CN+UACU3540313+22G1:102:5++2+5'\nRFF+BN:82267656'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+RULED:139:6'\nMEA+AAE+T+KGM:2330'\nMEA+AAE+G+KGM:21275'\nMEA+AAE+VGM+KGM:23605'\nSEL+8209618+CA'\nFTX+AAA+++FOODSTUFF'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810080000:203'\nNAD+CF+HLL:160:166'\nEQD+CN+UACU5983650+45G1:102:5++2+5'\nRFF+BN:50068178'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+GBSOU:139:6'\nLOC+7+IEDRO:139:6'\nMEA+AAE+T+KGM:3800'\nMEA+AAE+G+KGM:20000'\nSEL+34964+SH'\nFTX+AAA+++PLASTICWARE'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810060000:203'\nNAD+CF+HLL:160:166'\nEQD+CN+TLLU5217443+45G1:102:5++2+5'\nRFF+BN:53733912'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+GBSOU:139:6'\nLOC+7+GBBRF:139:6'\nMEA+AAE+T+KGM:3700'\nMEA+AAE+G+KGM:23165'\nMEA+AAE+VGM+KGM:26865'\nSEL+UASC820677+SH'\nFTX+AAA+++SAUCES'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN+GVCU4077501+42G1:102:5++2+5'\nRFF+BN:54400080'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+GBSOU:139:6'\nLOC+7+GBLIV:139:6'\nMEA+AAE+T+KGM:3740'\nMEA+AAE+G+KGM:25800'\nMEA+AAE+VGM+KGM:29540'\nSEL+1439574+CU'\nFTX+AAA+++INSIDE DOUBLE GOLD LACQUERED'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN+FDCU0184546+45G1:102:5++2+5'\nRFF+BN:59734424'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+GBSOU:139:6'\nLOC+7+GBBRF:139:6'\nMEA+AAE+T+KGM:3700'\nMEA+AAE+G+KGM:18386'\nMEA+AAE+VGM+KGM:22086'\nSEL+1443358+SH'\nFTX+AAA+++SAUCES'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN+HLXU1032616+22G1:102:5++6+5'\nRFF+BN:81975655'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+GBSOU:139:6'\nLOC+7+GBSOU:139:6'\nMEA+AAE+T+KGM:2350'\nMEA+AAE+G+KGM:19390'\nMEA+AAE+VGM+KGM:21740'\nSEL+HLD6551782+SH'\nSEL+02AZ003501+CA'\nSEL+002AQ01554+SH'\nSEL+002AZ00350+SH'\nSEL+HLD5651782+SH'\nSEL+002AQ01554+SH'\nSEL+02AZ003501+SH'\nSEL+HLD6551782+CU'\nSEL+6551782+CA'\nFTX+AAA+++PIMIENTO MORRON EN CONSERVAS'\nTDT+10+281MGE+1+13+HLLU:172:20+++MCMB2:103::SPIRIT OF MELBOURNE:IM'\nRFF+VON:217740'\nLOC+5+PEPAI:139:6'\nDTM+132:201810070706:203'\nNAD+CF+HLL:160:166'\nCNT+16:31'\nUNT+468+CFEITSAL003454'\nUNZ+1+3099'");

            //Create CUSRES EDI file with VE
            CreateDataFile(ediFile2,
               "UNA:+.'\nUNB+UNOA:2+HAPAG-LLOYD+ITSALSCT+181012:1402+3099'\nUNH+CFEITSAL003454+COPRAR:D:95B:UN:SMDG10'\nBGM+45:::LOADING ORDER+CFEITSAL003454+9'\nRFF+XXX:1'\nTDT+20+VOY_44074+1++HLL:172:20+++9V3818:103::MAERSK PATRAS'\nRFF+VON:218905'\nLOC+9+ITSAL:139:6++:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nDTM+133:201810142130:203'\nDTM+132:201810140800:203'\nNAD+CA+HLL:160:166'\nEQD+CN+SEGU2701478+22G1:102:5++2+5'\nRFF+BN:82173607'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+BEANR:139:6'\nLOC+7+NLTLB:139:6'\nMEA+AAE+T+KGM:2180'\nMEA+AAE+G+KGM:25056'\nMEA+AAE+VGM+KGM:27236'\nSEL+HLK0018487+CA'\nSEL+HLK0018487+SH'\nSEL+0018487+CA'\nFTX+AAA+++PASTA'\nTDT+10+188E+1+13+HLL:172:20+++9HA3756:103::MOLIVA:MT'\nRFF+VON:589735'\nLOC+5+ITTPS:139:6'\nDTM+132:201810091142:203'\nNAD+CF+HLL:160:166'\nEQD+CN+HLXU8419680+45G1:102:5++2+5'\nRFF+BN:50067427'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+NOOSL:139:6'\nMEA+AAE+T+KGM:3900'\nMEA+AAE+G+KGM:5831'\nMEA+AAE+VGM+KGM:9731'\nSEL+UASC 82083+AB'\nSEL+Y 6111470+AB'\nSEL+Y 6111469+AB'\nFTX+AAA+++ITALIAN PASTA'\nTDT+10++3+31'\nLOC+5+ITSAL:139:6'\nDTM+132:201810130000:203'\nNAD+CF+HLL:160:166'\nEQD+CN+TEMU6851404+45G1:102:5++2+5'\nRFF+BN:50067427'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+NOOSL:139:6'\nMEA+AAE+T+KGM:3890'\nMEA+AAE+G+KGM:7140'\nMEA+AAE+VGM+KGM:11030'\nSEL+UASC 82083+SH'\nSEL+Y 6111382-+SH'\nFTX+AAA+++ITALIAN PASTA'\nTDT+10++3+31'\nLOC+5+ITSAL:139:6'\nDTM+132:201810130000:203'\nNAD+CF+HLL:160:166'\nEQD+CN+HLXU1227367+22G1:102:5++2+5'\nRFF+BN:51067598'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+NOOSL:139:6'\nMEA+AAE+T+KGM:2350'\nMEA+AAE+G+KGM:21300'\nMEA+AAE+VGM+KGM:23650'\nSEL+8208288+SH'\nSEL+0010746+SH'\nFTX+AAA+++CHOPPED TOMATOES 6X2550G NET OTG'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810080000:203'\nNAD+CF+HLL:160:166'\nEQD+CN+FCIU3072600+22G1:102:5++2+5'\nRFF+BN:51401090'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+NOOSL:139:6'\nMEA+AAE+T+KGM:2220'\nMEA+AAE+G+KGM:10278'\nMEA+AAE+VGM+KGM:12498'\nSEL+1822925+AB'\nFTX+AAA+++TOMATO SAUCE'\nTDT+10++3+31'\nLOC+5+ITSAL:139:6'\nDTM+132:201810130000:203'\nNAD+CF+HLL:160:166'\nEQD+CN+TCLU4150748+42G1:102:5++2+5'\nRFF+BN:52067861'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+RULED:139:6'\nMEA+AAE+T+KGM:3710'\nMEA+AAE+G+KGM:25350'\nMEA+AAE+VGM+KGM:29060'\nSEL+M1464061+SH'\nSEL+M1464061+SH'\nFTX+AAA+++MINERAL WATER'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN+TCNU7787125+45G1:102:5++2+5'\nRFF+BN:54065946'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+NOOSL:139:6'\nMEA+AAE+T+KGM:3900'\nMEA+AAE+G+KGM:17240'\nMEA+AAE+VGM+KGM:21140'\nSEL+609347+AB'\nFTX+AAA+++MISTO DI NOCCIOLE, NOCCIOLE IN GUSC'\nTDT+10++3+31'\nLOC+5+ITSAL:139:6'\nDTM+132:201810130000:203'\nNAD+CF+HLL:160:166'\nEQD+CN+HLXU6526458+45G1:102:5++2+5'\nRFF+BN:54065946'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+NOOSL:139:6'\nMEA+AAE+T+KGM:4080'\nMEA+AAE+G+KGM:25780'\nMEA+AAE+VGM+KGM:29860'\nSEL+1440151+SH'\nFTX+AAA+++MISTO DI NOCCIOLE, NOCCIOLE IN GUSC'\nTDT+10++3+31'\nLOC+5+ITSAL:139:6'\nDTM+132:201810130000:203'\nNAD+CF+HLL:160:166'\nEQD+CN+HLXU1138547+22G1:102:5++2+5'\nRFF+BN:54065946'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+NOOSL:139:6'\nMEA+AAE+T+KGM:2350'\nMEA+AAE+G+KGM:7325'\nMEA+AAE+VGM+KGM:9675'\nSEL+1443026+AB'\nFTX+AAA+++MISTO DI NOCCIOLE, NOCCIOLE IN GUSC'\nTDT+10++3+31'\nLOC+5+ITSAL:139:6'\nDTM+132:201810110000:203'\nNAD+CF+HLL:160:166'\nEQD+CN+UACU4013894+22G1:102:5++2+5'\nRFF+BN:54399671'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+DKCPH:139:6'\nMEA+AAE+T+KGM:2300'\nMEA+AAE+G+KGM:21420'\nMEA+AAE+VGM+KGM:23720'\nSEL+HLA4659484+SH'\nSEL+HLA4659484+SH'\nSEL+4659484+CA'\nFTX+AAA+++ORANGE CONCENTRATE'\nTDT+10+189E+1+13+HLL:172:20+++9HA3756:103::MOLIVA:MT'\nRFF+VON:591050'\nLOC+5+ITCTA:139:6'\nDTM+132:201810091142:203'\nNAD+CF+HLL:160:166'\nEQD+CN+HLXU1195589+22G1:102:5++2+5'\nRFF+BN:54733596'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+DEHAM:139:6'\nMEA+AAE+T+KGM:2350'\nMEA+AAE+G+KGM:21840'\nMEA+AAE+VGM+KGM:24190'\nSEL+8208285+CU'\nFTX+AAA+++BEANS'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN+IPXU3892620+22G1:102:5++2+5'\nRFF+BN:54733596'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+DEHAM:139:6'\nMEA+AAE+T+KGM:2240'\nMEA+AAE+G+KGM:21340'\nMEA+AAE+VGM+KGM:23580'\nSEL+3269319+SH'\nFTX+AAA+++BEANS'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN+TEMU1472558+22G1:102:5++2+5'\nRFF+BN:55067809'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+NOOSL:139:6'\nMEA+AAE+T+KGM:2060'\nMEA+AAE+G+KGM:18708'\nMEA+AAE+VGM+KGM:20768'\nSEL+1441503+SH'\nSEL+048422+SH'\nFTX+AAA+++RED KIDNEY BEANS'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810090000:203'\nNAD+CF+HLL:160:166'\nEQD+CN++22GP:102:5++2+5'\nRFF+BN:55398868'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+RULED:139:6'\nMEA+AAE+T+KGM:2300'\nMEA+AAE+G+KGM:20585'\nFTX+AAA+++CANNED TOMATOES'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN+HLXU1222410+22G1:102:5++2+5'\nRFF+BN:55398868'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+RULED:139:6'\nMEA+AAE+T+KGM:2350'\nMEA+AAE+G+KGM:21600'\nMEA+AAE+VGM+KGM:23950'\nSEL+8209659+CA'\nFTX+AAA+++CANNED TOMATOES'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN++42PC:102:5++2+4'\nRFF+BN:55401201'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+DEHAM:139:6'\nMEA+AAE+T+KGM:5800'\nTDT+10++1+13'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN++42PC:102:5++2+4'\nRFF+BN:55401201'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+DEHAM:139:6'\nMEA+AAE+T+KGM:5800'\nTDT+10++1+13'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN++42PC:102:5++2+4'\nRFF+BN:55401201'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+DEHAM:139:6'\nMEA+AAE+T+KGM:5800'\nTDT+10++1+13'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN++42PC:102:5++2+4'\nRFF+BN:55401201'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+DEHAM:139:6'\nMEA+AAE+T+KGM:5800'\nTDT+10++1+13'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN++42PC:102:5++2+4'\nRFF+BN:55401201'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+DEHAM:139:6'\nMEA+AAE+T+KGM:5800'\nTDT+10++1+13'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN++42PC:102:5++2+4'\nRFF+BN:55401201'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+DEHAM:139:6'\nMEA+AAE+T+KGM:5800'\nTDT+10++1+13'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN+UACU3733436+22G1:102:5++2+5'\nRFF+BN:57066341'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+EEMUG:139:6'\nMEA+AAE+T+KGM:2300'\nMEA+AAE+G+KGM:11500'\nMEA+AAE+VGM+KGM:13800'\nSEL+1213170+CU'\nFTX+AAA+++TOMATOES'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN+HAMU1089390+22G1:102:5++2+5'\nRFF+BN:58399851'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+NOOSL:139:6'\nMEA+AAE+T+KGM:2300'\nMEA+AAE+G+KGM:20760'\nMEA+AAE+VGM+KGM:23060'\nSEL+6838407+SH'\nSEL+0010725+SH'\nSEL+6838407+CU'\nSEL+0010725+CU'\nFTX+AAA+++TOMATOES'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN+UACU3853302+22G1:102:5++2+5'\nRFF+BN:82247849'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+RULED:139:6'\nMEA+AAE+T+KGM:2290'\nMEA+AAE+G+KGM:22160'\nMEA+AAE+VGM+KGM:24450'\nSEL+8208326+SH'\nFTX+AAA+++STEEL WIRE'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN+CAIU2158297+22G1:102:5++2+5'\nRFF+BN:82265575'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+SEHEL:139:6'\nMEA+AAE+T+KGM:2185'\nMEA+AAE+G+KGM:21800'\nMEA+AAE+VGM+KGM:23985'\nSEL+018693+SH'\nSEL+018693+AB'\nFTX+AAA+++CHICK PEAS'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810080000:203'\nNAD+CF+HLL:160:166'\nEQD+CN+UACU3540313+22G1:102:5++2+5'\nRFF+BN:82267656'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+DEHAM:139:6'\nLOC+7+RULED:139:6'\nMEA+AAE+T+KGM:2330'\nMEA+AAE+G+KGM:21275'\nMEA+AAE+VGM+KGM:23605'\nSEL+8209618+CA'\nFTX+AAA+++FOODSTUFF'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810080000:203'\nNAD+CF+HLL:160:166'\nEQD+CN+UACU5983650+45G1:102:5++2+5'\nRFF+BN:50068178'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+GBSOU:139:6'\nLOC+7+IEDRO:139:6'\nMEA+AAE+T+KGM:3800'\nMEA+AAE+G+KGM:20000'\nSEL+34964+SH'\nFTX+AAA+++PLASTICWARE'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810060000:203'\nNAD+CF+HLL:160:166'\nEQD+CN+TLLU5217443+45G1:102:5++2+5'\nRFF+BN:53733912'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+GBSOU:139:6'\nLOC+7+GBBRF:139:6'\nMEA+AAE+T+KGM:3700'\nMEA+AAE+G+KGM:23165'\nMEA+AAE+VGM+KGM:26865'\nSEL+UASC820677+SH'\nFTX+AAA+++SAUCES'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN+GVCU4077501+42G1:102:5++2+5'\nRFF+BN:54400080'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+GBSOU:139:6'\nLOC+7+GBLIV:139:6'\nMEA+AAE+T+KGM:3740'\nMEA+AAE+G+KGM:25800'\nMEA+AAE+VGM+KGM:29540'\nSEL+1439574+CU'\nFTX+AAA+++INSIDE DOUBLE GOLD LACQUERED'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN+FDCU0184546+45G1:102:5++2+5'\nRFF+BN:59734424'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+GBSOU:139:6'\nLOC+7+GBBRF:139:6'\nMEA+AAE+T+KGM:3700'\nMEA+AAE+G+KGM:18386'\nMEA+AAE+VGM+KGM:22086'\nSEL+1443358+SH'\nFTX+AAA+++SAUCES'\nTDT+10++9'\nLOC+5+ITSAL:139:6'\nDTM+132:201810142130:203'\nNAD+CF+HLL:160:166'\nEQD+CN+HLXU1032616+22G1:102:5++6+5'\nRFF+BN:81975655'\nTMD+3'\nLOC+9+ITSAL:139:6+:BER:ZZZ:SALERNO CONTAINER TERMINAL SPA'\nLOC+11+GBSOU:139:6'\nLOC+7+GBSOU:139:6'\nMEA+AAE+T+KGM:2350'\nMEA+AAE+G+KGM:19390'\nMEA+AAE+VGM+KGM:21740'\nSEL+HLD6551782+SH'\nSEL+02AZ003501+CA'\nSEL+002AQ01554+SH'\nSEL+002AZ00350+SH'\nSEL+HLD5651782+SH'\nSEL+002AQ01554+SH'\nSEL+02AZ003501+SH'\nSEL+HLD6551782+CU'\nSEL+6551782+CA'\nFTX+AAA+++PIMIENTO MORRON EN CONSERVAS'\nTDT+10+281MGE+1+13+HLLU:172:20+++MCMB2:103::SPIRIT OF MELBOURNE:IM'\nRFF+VON:217740'\nLOC+5+PEPAI:139:6'\nDTM+132:201810070706:203'\nNAD+CF+HLL:160:166'\nCNT+16:31'\nUNT+468+CFEITSAL003454'\nUNZ+1+3099'");

            MTNSignon(TestContext);

        }


        [TestMethod]
        public void CoprarVoyageTranslation()
        {
            MTNInitialize();
            
            // 1a. Open EDI Operations
            FormObjectBase.NavigationMenuSelection(@"EDI Functions|EDI Operations");
            ediOperationsForm = new EDIOperationsForm(@"EDI Operations TT1");

            // 1b. Delete Existing EDI messages relating to this test.
            ediOperationsForm.DeleteEDIMessages(@"Load", @"44074");

            // 2. Load CUSRES VN and check that the cargo type on the stop is recognised as a Motor Vehicle
            ediOperationsForm.LoadEDIMessageFromFile(ediFile1);
            ediOperationsForm.LoadEDIMessageFromFile(ediFile2);
            //ediOperationsForm.ShowEDIDataTable(@"4040");
            ediOperationsForm.GetTabTableGeneric(@"EDI Details", @"4040");

            //MTNControlBase.FindClickRowInTable(ediOperationsForm.tblEDIMessages, @"Status^Loaded~File Name^" + ediFile1, rowHeight: 16, xOffset: 150);
            ediOperationsForm.TblEDIMessages.FindClickRow(@"Status^Loaded~File Name^" + ediFile1, xOffset: 150);
            string voyCode = MTNControlBase.GetValueInEditTable(ediOperationsForm.tblEDIDetails, @"Voyage");
            string fileName = MTNControlBase.GetValueInEditTable(ediOperationsForm.tblEDIDetails, @"File Name");
            Assert.IsTrue(voyCode == @"VOY_44074", @"Voyage Translation failed: Voyage expected VOY_44074, actual " + voyCode);
            Assert.IsTrue(fileName.Contains(@"COPRARA"), @"Incorrect file name: expected = COPRARA.edi");

            //MTNControlBase.FindClickRowInTable(ediOperationsForm.tblEDIMessages, @"Status^Loaded~File Name^" + ediFile2, rowHeight: 16, xOffset: 150);
            ediOperationsForm.TblEDIMessages.FindClickRow(@"Status^Loaded~File Name^" + ediFile2, xOffset: 150);
            voyCode = MTNControlBase.GetValueInEditTable(ediOperationsForm.tblEDIDetails, @"Voyage");
            fileName = MTNControlBase.GetValueInEditTable(ediOperationsForm.tblEDIDetails, @"File Name");
            Assert.IsTrue(voyCode == @"VOY_44074", @"Voyage Translation failed: Voyage expected VOY_44074, actual " + voyCode);
            Assert.IsTrue(fileName.Contains(@"COPRARB"), @"Incorrect file name: expected = COPRARB.edi");

        }

    

    }

}
